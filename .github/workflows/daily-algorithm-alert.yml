name: daily-algorithm-alert

on:
  schedule:
    - cron: '0 11 * * *'   # Run daily at 8 PM
    # - cron: '0 11 * * 1'   # Run weekly on Mondays at 8 PM
    # - cron: '0 11 1 * *'  # Run monthly on the 1st at 8 PM

jobs:
  alert-build:
    runs-on: ubuntu-latest

    steps:

      - name: Set Timezone to Asia/Seoul
        run: sudo timedatectl set-timezone Asia/Seoul

      - name: Print Current time in workflow
        run: date

      - name: checkout repository
        uses: actions/checkout@v4

      - name: POST algorithm repository daily alert to SLACK
        run: |
          chmod +x ./shell-scripts/statistics-algorithm-java-files.sh
          bash shell-scripts/statistics-algorithm-java-files.sh

      - name: Slack Message Send & Statistics
        run: |
  
          # if [ ${DAILY_COUNT} -lt 1 ]; then 
          #  MSG="ë” ë¶„ë°œí•´ì•¼ í•  ê²ƒ ê°™ì•„ìš”!ğŸ˜‚"
          # elif [ ${DAILY_COUNT} -ge 2 -a ${DAILY_COUNT} -lt 3 ]; then
          #  MSG="ì§€ê¸ˆê¹Œì§€ ì˜í•˜ê³  ê³„ì‹œë„¤ìš”. í™”ì´íŒ…ì…ë‹ˆë‹¤!ğŸ˜˜"
          # elif [ ${DAILY_COUNT} -ge 3 -a ${DAILY_COUNT} -lt 4 ]; then
          #  MSG="ëª©í‘œë¥¼ ê±°ì˜ ë‹¬ì„±í•˜ì…¨ì–´ìš”! ëŒ€ë‹¨í•©ë‹ˆë‹¤.ğŸ‘ğŸ½"
          # else
          #  MSG="4 ë¬¸ì œ ì´ìƒ í‘¸ì…”ì„œ, ì¡´ê²½ìŠ¤ëŸ½ìŠµë‹ˆë‹¤.ğŸ‰"
          # fi
          
          case ${{ env.DAILY_COUNT}} in
            0)
              MSG="ë” ë¶„ë°œí•´ì•¼ í•  ê²ƒ ê°™ì•„ìš”!ğŸ˜‚"
              ;;
            2 | 3)
              MSG="ì§€ê¸ˆê¹Œì§€ ì˜í•˜ê³  ê³„ì‹œë„¤ìš”. í™”ì´íŒ…ì…ë‹ˆë‹¤!ğŸ˜˜"
              ;;
            4)
              MSG="ëª©í‘œë¥¼ ê±°ì˜ ë‹¬ì„±í•˜ì…¨ì–´ìš”! ëŒ€ë‹¨í•©ë‹ˆë‹¤.ğŸ‘ğŸ½"
              ;;
            *)
              MSG="4 ë¬¸ì œ ì´ìƒ í‘¸ì…”ì„œ, ì¡´ê²½ìŠ¤ëŸ½ìŠµë‹ˆë‹¤.ğŸ‰"
              ;;
          esac
          
          DAILY_MSG="ì•Œê³ ë¦¬ì¦˜ í’€ê¸°ì— ë”± ì¢‹ì€ ë°¤ì´ë„¤ìš”!\nì˜¤ëŠ˜ ë‚ ì§œ_(${TODAY})_ê¸°ì¤€ìœ¼ë¡œ, ${{ env.DAILY_COUNT }}ë¬¸ì œë¥¼ í•´ê²°í•˜ì…¨ì–´ìš”!ğŸ’ª*\nğŸ“Ší†µê³„ë¥¼ ë³´ë©´, ì´ë²ˆ ì£¼ì—ëŠ” ${{ env.WEEKLY_COUNT }}ë¬¸ì œ, ì´ë²ˆ ë‹¬ì—ëŠ” ${{ env.MONTHLY_COUNT }}ë¬¸ì œë¥¼ í‘¸ì…¨ìŠµë‹ˆë‹¤! ${MSG}\nìì„¸í•œ ë‚´ìš©ì„ ë³´ì‹œë ¤ë©´ ğŸ”—<https://github.com/yeeooni/baekjoon-slove|ì—¬ê¸°>ë¥¼ í´ë¦­í•˜ì„¸ìš”."
          
          # SLACK channel to SEND
          curl -X POST --data-urlencode "payload={\"text\": \"${DAILY_MSG}\"}" ${{ secrets.SLACK_WEBHOOKS_URL }}
          
            
          
          
          
